
@{
    ViewBag.Title = "Detail";
    Layout = "~/Views/Shared/UserLayout.cshtml";
}


<style>
    .card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.card:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
}
.card-title {
    font-size: 1.2rem;
    color: #333;
}
.card-text {
    font-size: 0.9rem;
    color: #666;
}
.product-img img {
        width: 250px; /* Fixed width */
        height: 250px; /* Fixed height */
        object-fit: cover; /* Maintain aspect ratio and crop if needed */
    }
</style>
<!-- Carousel Start -->
<div class="container-fluid mb-3">
    <div class="row px-xl-5">
        <div class="col-lg-8">
            <div id="header-carousel" class="carousel slide carousel-fade mb-30 mb-lg-0" data-ride="carousel">
                <ol class="carousel-indicators">
                    <li data-target="#header-carousel" data-slide-to="0" class="active"></li>
                    <li data-target="#header-carousel" data-slide-to="1"></li>
                    <li data-target="#header-carousel" data-slide-to="2"></li>
                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item position-relative active" style="height: 430px;">
                        <img class="position-absolute w-100 h-100" src="~/Assets/Shop/img/foodsdrinks.jpg" style="object-fit: cover;">
                        <div class="carousel-caption d-flex flex-column align-items-center justify-content-center">
                            <div class="p-3" style="max-width: 700px;">
                                <h1 class="display-4 text-white mb-3 animate__animated animate__fadeInDown">Snacks</h1>
                                <p class="mx-md-5 px-5 animate__animated animate__bounceIn">The University of Cebu's canteen offers a wide variety of meals and snacks to cater to the diverse tastes of its student body.</p>
                                <a class="btn btn-outline-light py-2 px-4 mt-3 animate__animated animate__fadeInUp" href="/Home/ShopList?categoryId=2">Shop Now</a>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item position-relative" style="height: 430px;">
                        <img class="position-absolute w-100 h-100" src="~/Assets/Shop/img/uniforms.jpg" style="object-fit: cover;">
                        <div class="carousel-caption d-flex flex-column align-items-center justify-content-center">
                            <div class="p-3" style="max-width: 700px;">
                                <h1 class="display-4 text-white mb-3 animate__animated animate__fadeInDown">Uniforms</h1>
                                <p class="mx-md-5 px-5 animate__animated animate__bounceIn">The University of Cebu features distinct uniforms for its students, tailored to various departments and academic levels.</p>
                                <a class="btn btn-outline-light py-2 px-4 mt-3 animate__animated animate__fadeInUp" href="/Home/ShopList?categoryId=4">Shop Now</a>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item position-relative" style="height: 430px;">
                        <img class="position-absolute w-100 h-100" src="~/Assets/Shop/img/DepartmentalShirts.jpg" style="object-fit: cover;">
                        <div class="carousel-caption d-flex flex-column align-items-center justify-content-center">
                            <div class="p-3" style="max-width: 700px;">
                                <h1 class="display-4 text-white mb-3 animate__animated animate__fadeInDown">Departmental Shirts</h1>
                                <p class="mx-md-5 px-5 animate__animated animate__bounceIn">A departmental t-shirt is a custom-designed shirt representing a specific department or team within an organization, school, or event. </p>
                                <a class="btn btn-outline-light py-2 px-4 mt-3 animate__animated animate__fadeInUp" href="/Home/ShopList?categoryId=5">Shop Now</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="product-offer mb-30" style="height: 200px;">
                <img class="img-fluid" src="~/Assets/Shop/img/uniformUC.jpg" alt="">
                <div class="offer-text">
                    <h6 class="text-white text-uppercase">Lower Price</h6>
                    <h3 class="text-white mb-3">Special Offer</h3>
                    <a href="/Home/DiscountedProducts" class="btn btn-primary">Shop Now</a>
                </div>
            </div>
            <div class="product-offer mb-30" style="height: 200px;">
                <img class="img-fluid" src="~/Assets/Shop/img/Breakfast.jpg" alt="">
                <div class="offer-text">
                    <h6 class="text-white text-uppercase">Lower Price</h6>
                    <h3 class="text-white mb-3">Special Offer</h3>
                    <a href="/Home/DiscountedProducts" class="btn btn-primary">Shop Now</a>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Carousel End -->
<!-- Featured Start -->
<div class="container-fluid pt-5">
    <div class="row px-xl-5 pb-3">
        <div class="col-lg-3 col-md-6 col-sm-12 pb-1">
            <div class="d-flex align-items-center bg-light mb-4" style="padding: 30px;">
                <h1 class="fa fa-award text-primary m-0 mr-3"></h1>
                <h5 class="font-weight-semi-bold m-0">Quality Product</h5>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-12 pb-1">
            <div class="d-flex align-items-center bg-light mb-4" style="padding: 30px;">
                <h1 class="fa fa-shipping-fast text-primary m-0 mr-2"></h1>
                <h5 class="font-weight-semi-bold m-0">Fast Delivery</h5>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-12 pb-1">
            <div class="d-flex align-items-center bg-light mb-4" style="padding: 30px;">
                <h1 class="fas fa-ticket-alt text-primary m-0 mr-3"></h1>
                <h5 class="font-weight-semi-bold m-0">Vouchers</h5>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-12 pb-1">
            <div class="d-flex align-items-center bg-light mb-4" style="padding: 30px;">
                <h1 class="fa fa-tags text-primary m-0 mr-3"></h1>
                <h5 class="font-weight-semi-bold m-0">Campus Deals</h5>
            </div>
        </div>
    </div>
</div>
<!-- Featured End -->
<!-- Categories Start -->
<div class="container-fluid pt-5">
    <h2 class="section-title position-relative text-uppercase mx-xl-5 mb-4"><span class="bg-secondary pr-3">Categories</span></h2>
    <div class="row px-xl-5 pb-3">
        <div class="col-lg-3 col-md-4 col-sm-6 pb-1">
            <a class="text-decoration-none" href="/Home/ShopList?categoryId=2">
                <div class="cat-item d-flex align-items-center mb-4">
                    <div class="overflow-hidden" style="width: 100px; height: 100px;">
                        <img class="img-fluid" src="~/Assets/Shop/img/Snacks.jpg" alt="">
                    </div>
                    <div class="flex-fill pl-3">
                        <h6>Snacks</h6>
                        <small class="text-body">100 Products</small>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-lg-3 col-md-4 col-sm-6 pb-1">
            <a class="text-decoration-none" href="/Home/ShopList?categoryId=0">
                <div class="cat-item img-zoom d-flex align-items-center mb-4">
                    <div class="overflow-hidden" style="width: 100px; height: 100px;">
                        <img class="img-fluid" src="~/Assets/Shop/img/Drinks.jpg" alt="">
                    </div>
                    <div class="flex-fill pl-3">
                        <h6>Beverage</h6>
                        <small class="text-body">100 Products</small>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-lg-3 col-md-4 col-sm-6 pb-1">
            <a class="text-decoration-none" href="/Home/ShopList?categoryId=3">
                <div class="cat-item img-zoom d-flex align-items-center mb-4">
                    <div class="overflow-hidden" style="width: 100px; height: 100px;">
                        <img class="img-fluid" src="~/Assets/Shop/img/Lunch.jpg" alt="">
                    </div>
                    <div class="flex-fill pl-3">
                        <h6>Lunch</h6>
                        <small class="text-body">100 Products</small>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-lg-3 col-md-4 col-sm-6 pb-1">
            <a class="text-decoration-none" href="/Home/ShopList?categoryId=1">
                <div class="cat-item img-zoom d-flex align-items-center mb-4">
                    <div class="overflow-hidden" style="width: 100px; height: 100px;">
                        <img class="img-fluid" src="~/Assets/Shop/img/Breakfast.jpg" alt="">
                    </div>
                    <div class="flex-fill pl-3">
                        <h6>Breakfast</h6>
                        <small class="text-body">100 Products</small>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-lg-3 col-md-4 col-sm-6 pb-1">
            <a class="text-decoration-none" href="/Home/ShopList?categoryId=4">
                <div class="cat-item img-zoom d-flex align-items-center mb-4">
                    <div class="overflow-hidden" style="width: 100px; height: 100px;">
                        <img class="img-fluid" src="~/Assets/Shop/img/uniformUC.jpg" alt="">
                    </div>
                    <div class="flex-fill pl-3">
                        <h6>Uniforms</h6>
                        <small class="text-body">100 Products</small>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-lg-3 col-md-4 col-sm-6 pb-1">
            <a class="text-decoration-none" href="/Home/ShopList?categoryId=5">
                <div class="cat-item img-zoom d-flex align-items-center mb-4">
                    <div class="overflow-hidden" style="width: 100px; height: 100px;">
                        <img class="img-fluid" src="~/Assets/Shop/img/DepartmentalShirts.jpg" alt="">
                    </div>
                    <div class="flex-fill pl-3">
                        <h6>Departmental Shirts</h6>
                        <small class="text-body">100 Products</small>
                    </div>
                </div>
            </a>
        </div>
    </div>
</div>
<!-- Shops Section -->
<div class="container-fluid pt-5">
    <h2 class="section-title position-relative text-uppercase mx-xl-5 mb-4">
        <span class="bg-secondary pr-3">Available Stores</span>
    </h2>
    <div class="row px-xl-5">
        @{
            var store = ViewBag.Shops as List<UCGrab.Database.Store>;
        }


        @if (store != null && store.Any())
        {
            foreach (var shop in store)
            {
                var storeimage = shop.Image_Store?.FirstOrDefault()?.image_file ?? "/images/no-image.png";

                <div class="col-lg-4 col-md-6 col-sm-12 pb-3">
                    <a href="/Home/Shop/?storeId=@shop.user_id" class="text-decoration-none">
                        <div class="card text-center border-0 shadow-sm">
                            <!-- Shop Image -->
                            <img src="~/UploadedFiles/@storeimage" class="card-img-top" alt="@shop.store_name" style="height: 200px; object-fit: cover;">
                            <!-- Shop Details -->
                            <div class="card-body">
                                <h5 class="card-title font-weight-bold">@shop.store_name</h5>
                            </div>
                        </div>
                     </a>
               </div>
            }
        }
        else
        {
            <p class="text-center w-100">No shops available at the moment.</p>
        }
    </div>
</div>

<!-- Products Section -->
<div class="container-fluid pt-5 pb-3">
    <h2 class="section-title position-relative text-uppercase mx-xl-5 mb-4"><span class="bg-secondary pr-3">Products</span></h2>
    <div class="row px-xl-5">
       @{
           var products = ViewBag.Products as List<UCGrab.Database.Product>;
    }

    @if (products != null && products.Any())
    {
        foreach (var product in products)
        {
            // Handle null or missing images
            var firstImage = product.Image_Product?.FirstOrDefault()?.image_file ?? "/images/no-image.png";

            <div class="col-lg-3 col-md-4 col-sm-6 pb-1">
                <div class="product-item bg-light mb-4">
                    <div class="product-img position-relative overflow-hidden">
                        <!-- Use the resolved image path -->
                        <img class="img-fluid w-100" src="~/UploadedFiles/@firstImage" alt="@product.product_name">
                        <div class="product-action">
                            <a class="btn btn-outline-dark btn-square" onclick="onAddCart(@product.id, @product.price.ToString("N2"))"><i class="fa fa-shopping-cart"></i></a>
                            <a class="btn btn-outline-dark btn-square" onclick="onAddFav(@product.id)"><i class="far fa-heart"></i></a>
                            <a class="btn btn-outline-dark btn-square" href="/Home/Detail/@product.id"><i class="fa fa-info-circle"></i></a>
                        </div>
                    </div>
                    <div class="text-center py-4">
                        <h5 class="font-weight-semi-bold">@product.product_name</h5>
                        <p class="text-muted">₱@product.price</p>
                    </div>
                </div>
            </div>
        }
    }
    else
    {
        <p class="text-center w-100">No products available at the moment.</p>
    }

    </div>
</div>
<!-- Products End -->
<!-- Vendor Start -->

<div class="container-fluid py-5">
    <div class="row px-xl-5">
        <div class="col">
            <div class="owl-carousel vendor-carousel">
                <div class="bg-light p-4">
                    <img src="~/Assets/Shop/img/logo1.jpg" alt="">
                </div>
                <div class="bg-light p-4">
                    <img src="~/Assets/Shop/img/psits.jpg" alt="">
                </div>
                <div class="bg-light p-4">
                    <img src="~/Assets/Shop/img/comstudies.png" alt="">
                </div>
                <div class="bg-light p-4">
                    <img src="~/Assets/Shop/img/lmfocus.jpg" alt="">
                </div>
                <div class="bg-light p-4">
                    <img src="~/Assets/Shop/img/lmscholar.jpg" alt="">
                </div>
                <div class="bg-light p-4">
                    <img src="~/Assets/Shop/img/uclm.jpg" alt="">
                </div>
                <div class="bg-light p-4">
                    <img src="~/Assets/Shop/img/lmsh.jpg" alt="">
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    function onAddCart(prodId, price) {
        var qty = 1; // Default quantity

        Swal.fire({
            title: "Are you sure?",
            icon: "question",
            confirmButtonColor: "#3085d6",
            cancelButtonColor: "#d33",
            showCancelButton: true,
            confirmButtonText: "OK",
        }).then((result) => {
            if (result.isConfirmed) {
                $.post("/Home/AddCart",
                    {
                        prodId: prodId,
                        qty: qty,
                        price: price // Pass the discounted price
                    },
                    function (data, status) {
                        if (data.code == 0) {
                            Swal.fire(data.message, "", "success");
                            if (typeof loadCartCount === "function") {
                                loadCartCount();
                            }
                        } else {
                            Swal.fire(data.message, "", "error");
                        }
                    }).fail(function (xhr, status, error) {
                        Swal.fire("Error adding to cart!", error, "error");
                    });
            }
        });
    }

     function onAddFav(prodId) {
         var qty = 1; // Default quantity

         Swal.fire({
             title: "Are you sure?",
             icon: "question",
             confirmButtonColor: "#3085d6",
             cancelButtonColor: "#d33",
             showCancelButton: true,
             confirmButtonText: "OK",
         }).then((result) => {
             if (result.isConfirmed) {
                 $.post("/Home/AddToFavorites",
                     {
                         prodId: prodId,
                         qty: qty
                     },
                     function (data, status) {
                         if (data.code == 0) {
                             Swal.fire(data.message, "", "success");
                             if (typeof loadCartCount === "function") {
                                 loadCartCount();
                             }
                         } else {
                             Swal.fire(data.message, "", "error");
                         }
                     }).fail(function (xhr, status, error) {
                         Swal.fire("Error adding to favorites!", error, "error");
                     });
             }
         });
     }


</script>
<script>
    $(document).ready(function () {
        // Check if categories are presented
        var hasCategories = $('#store-title').text().trim().length > 0; // Adjust selector if categories have a different identifier.

        // Hide the "Filter by Size" section if categories are present
        if (hasCategories) {
            $('h5:contains("Filter by size")').hide(); // Hides the header
            $('h5:contains("Filter by size")').next('.bg-light').hide(); // Hides the filter block
        }
    });
</script>
<script>
     $(document).ready(function () {
        function filterProducts() {
            var minPrice = null;
            var maxPrice = null;

            if ($("#price-1").prop("checked")) {
                minPrice = 0;
                maxPrice = 100;
            } else if ($("#price-2").prop("checked")) {
                minPrice = 100;
                maxPrice = 200;
            } else if ($("#price-3").prop("checked")) {
                minPrice = 200;
                maxPrice = 300;
            } else if ($("#price-4").prop("checked")) {
                minPrice = 300;
                maxPrice = 400;
            } else if ($("#price-5").prop("checked")) {
                minPrice = 1000;
                maxPrice = 1500;
            } else if ($("#price-all").prop("checked")) {
                minPrice = null;
                maxPrice = null;
            }

            $("#product-list .col-lg-4").each(function () {
                var price = parseFloat($(this).data("price"));

                if ((minPrice === null || price >= minPrice) && (maxPrice === null || price <= maxPrice)) {
                    $(this).show();
                } else {
                    $(this).hide();
                }
            });
        }

        $("input[name='priceFilter']").change(function () {
            filterProducts();
        });

        filterProducts();

        var products = $("#product-list .col-lg-4").get();

        products.sort(function (a, b) {
            var priceA = parseFloat($(a).data("price"));
            var priceB = parseFloat($(b).data("price"));
            return priceA - priceB;
        });

        $("#product-list").empty().append(products);
    });

</script>